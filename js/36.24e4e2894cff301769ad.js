(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"144":function(e,t,n){"use strict";n.d(t,"b",(function(){return f}));var a=n(5),r=n(10),c=n(11),o=n(20),i=n(15),s=n(16),u=n(6),l=n(26),d=n.n(l),m=n(142),_=function(e){Object(i.a)(ErrorBoundary,e);var t=Object(s.a)(ErrorBoundary);function ErrorBoundary(){var e;Object(r.a)(this,ErrorBoundary);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a)),Object(u.a)(Object(o.a)(e),"state",{"hasError":!1}),e}return Object(c.a)(ErrorBoundary,[{"key":"componentDidMount","value":function componentDidMount(){}},{"key":"componentDidCatch","value":function componentDidCatch(e,t){this.setState({"hasError":!0}),e.message="".concat(e.message," - componentStack: ").concat(t.componentStack),console.log("我是错误",e)}},{"key":"render","value":function render(){return this.state.hasError?"":this.props.children}}]),ErrorBoundary}(d.a.Component),f=function errorBoundary(e){return function(t){Object(i.a)(_class,t);var n=Object(s.a)(_class);function _class(){return Object(r.a)(this,_class),n.apply(this,arguments)}return Object(c.a)(_class,[{"key":"render","value":function render(){return Object(m.jsx)(_,{"children":Object(m.jsx)(e,Object(a.a)({},this.props))})}}]),_class}(d.a.PureComponent)};t.a=f},"149":function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(4),o=n(1),i=n(26),s=n(143),u=n(150),l=n.n(u),d=n(144),m=n(142);t.a=Object(d.b)((function Header(e){var t=e.content,n=void 0===t?{}:t,a=n.type,u=void 0===a?"":a,d=n&&n.title||"",_=n&&n.imageUrl||"",f=n&&n.backgroundColor||"",h=n&&n.prevIcon||"",p=n&&n.moreIcon||"",b=n&&n.moreText||"",x=n&&n.fizeColor||"",j=n&&n.moreTextColor||x||"",g=o.default.getCurrentInstance();Object(i.useEffect)((function(){Object(o.pageScrollTo)({"scrollTop":0})}),[]);var O=function(){var t=Object(c.a)(r.a.mark((function _callee(){return r.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(!e.content.goBackHandle){t.next=3;break}return e.content.goBackHandle(),t.abrupt("return");case 3:if(!g.router.path.includes("back=home")){t.next=6;break}return o.default.reLaunch({"url":"/pages/index/index"}),t.abrupt("return",!1);case 6:if(!window||!window.grounds||"/pages/index/index"!==g.router.path&&"/pages/my/index"!==g.router.path&&"/pages/found/index"!==g.router.path){t.next=10;break}window.ground.close(),t.next=22;break;case 10:if("share"!==u){t.next=14;break}o.default.reLaunch({"url":"/pages/index/index"}),t.next=22;break;case 14:return t.prev=14,t.next=17,o.default.navigateBack({"delta":1});case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(14),o.default.reLaunch({"url":"/pages/index/index"});case 22:case"end":return t.stop()}}),_callee,null,[[14,19]])})));return function h5GoBackHandle(){return t.apply(this,arguments)}}(),w=_?{"backgroundImage":"url(".concat(_,")")}:{"backgroundColor":f};return Object(m.jsx)(s.View,{"className":l.a.headerBox,"style":w,"children":Object(m.jsxs)(s.View,{"className":l.a.header,"style":w,"children":[Object(m.jsx)(s.View,{"className":l.a.headerPrev,"children":h&&Object(m.jsx)(s.Image,{"onClick":O,"src":h,"mode":"aspectFit","className":l.a.headerPrevPic})}),Object(m.jsx)(s.View,{"className":l.a.headerTitle,"children":Object(m.jsx)(s.Text,{"className":l.a.headerTitleText,"style":{"color":x},"children":d})}),Object(m.jsxs)(s.View,{"className":l.a.headerMore,"children":[p&&Object(m.jsx)(s.Image,{"src":p,"mode":"aspectFit","onClick":function moreIconHandle(){if(window&&window.grounds)try{window.grounds.openShare(location.href,"凤娱指数-影剧综榜单","凤凰新闻","https://x0.ifengimg.com/ucms/2021_50/42603B06AF7D0F555A12FC2E60ED0C61CFDB9709_size27_w432_h432.png","brand_mxdb01")}catch(e){try{window.grounds.openShare(location.href,"凤娱指数-影剧综榜单","凤凰新闻","https://x0.ifengimg.com/ucms/2021_50/42603B06AF7D0F555A12FC2E60ED0C61CFDB9709_size27_w432_h432.png","brand_mxdb01","")}catch(e){}}},"className":l.a.headerMorePic}),e.children,b&&Object(m.jsx)(s.Text,{"className":l.a.headerMoreText,"onClick":function moreTextHandle(){e.content.moreTextHandle()},"style":{"color":j},"children":b})]})]})})}))},"150":function(e,t,n){e.exports={"headerBox":"index-module__headerBox___1_u1D","headerBoxWx":"index-module__headerBoxWx___3wJqw","header":"index-module__header___6NxCV","headerWx":"index-module__headerWx___3y-VP","headerPrev":"index-module__headerPrev___12MB1","headerPrevPic":"index-module__headerPrevPic___212ke","headerTitle":"index-module__headerTitle___25jwe","headerTitleText":"index-module__headerTitleText___3LAcX","headerMore":"index-module__headerMore___2nNrE","headerMorePic":"index-module__headerMorePic___ydU02","headerMoreText":"index-module__headerMoreText___fvvfk"}},"167":function(e,t,n){"use strict";n.d(t,"a",(function(){return Rate}));var a=n(12),r=n(26),c=n(143),o=n(145),i=n.n(o),s=n(174),u=n.n(s),l=n(1),d=n(142),m=i.a.bind(u.a);function Rate(e){var t=e.score,n=void 0===t?0:t,o=e.starSize,i=void 0===o?38:o,s=e.readonly,_=void 0===s||s,f=e.margin,h=void 0===f?5:f,p=e.onChange,b=Object(r.useState)(n),x=Object(a.a)(b,2),j=x[0],g=x[1];function handleClick(e){return function(e){!function changeScore(e){if(_)return;Object(l.createSelectorQuery)().select("#starwrap").boundingClientRect((function(t){var a=0,r=0,c=0,o=e.touches[0].pageX,s=t.left,u=i,l=h,d=s+5*u+4*l;o>=s&&o<=d?(0<=(r=o-s-(c=Math.floor((o-s)/(u+l)))*(u+l))&&r<.5*u?a=c+.5:(.5*u<=r&&r<u||u<=r)&&(a=c+1),a!=n&&g(a)):o<s?g(0):o>d&&g(5),p&&p(a)})).exec()}(e)}}return Object(r.useEffect)((function(){return g(n),function(){}}),[n]),Object(d.jsx)(c.View,{"className":u.a.scoreWrap,"id":"starwrap","children":[1,2,3,4,5].map((function(e,t){var n="".concat("https://x0.ifengimg.com/fe/ifengVane",j>t?j>=t+1?"/star_fill.png":"/star_half.png":"/star.png");return Object(d.jsx)(c.View,{"className":m({"starLen":!0,"star":!0}),"hoverClass":m("starActive"),"hoverStayTime":100,"style":{"width":"".concat(i,"px"),"height":"".concat(i,"px"),"marginRight":"".concat(h,"px"),"backgroundImage":"url(".concat(n,")"),"backgroundSize":"cover"},"onClick":handleClick()},e)}))})}},"174":function(e,t,n){e.exports={"scoreWrap":"index-module__scoreWrap___jLMMe","starLen":"index-module__starLen___1Quwl","star":"index-module__star___2ukPQ","starActive":"index-module__starActive___2YjLw"}},"208":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"f",(function(){return _})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return x})),n.d(t,"h",(function(){return j}));var a=n(0),r=n.n(a),c=n(4),o=n(13),i=n(21),s={"code":200,"level":200,"message":"success","description":"","data":{"dramaId":"6874236891051335720","title":"神仙姐姐","category":"tv-play","platform":'["优酷视频"]',"coverImage":'["https://x0.ifengimg.com/ucms/2022_25/433D697B04AE782D4E6D646B8DEEFA1C6C9CEA2E_size247_w1080_h1512.jpg"]',"description":"神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐","publicScore":0,"publicScoreDistribution":'{"fiveStarCount":4,"fourHalfStarCount":5,"fourStarCount":8,"halfStarCount":0,"oneHalfStarCount":0,"oneStarCount":1,"threeHalfStarCount":14,"threeStarCount":1,"twoHalfStarCount":9,"twoStarCount":0}',"performanceScore":0,"commentTotal":28,"commentPeople":0,"publicScorePeople":42,"performanceScorePeople":0,"searchHeat":0,"topDeadline":1642759685717,"showTime":1642175999999,"finishTime":1642262399999},"succeed":!0,"msg":"success"},u=n(228),l={"code":200,"level":200,"message":"success","description":"","data":{"ranking":0,"type":null,"year":null,"dramaContent":{"dramaId":"6874236891051335720","title":"神仙姐姐","category":"tv-play","platform":'["优酷视频"]',"coverImage":'["https://x0.ifengimg.com/ucms/2022_25/433D697B04AE782D4E6D646B8DEEFA1C6C9CEA2E_size247_w1080_h1512.jpg"]',"description":"神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐","publicScore":0,"publicScoreDistribution":'{"fiveStarCount":4,"fourHalfStarCount":5,"fourStarCount":8,"halfStarCount":0,"oneHalfStarCount":0,"oneStarCount":1,"threeHalfStarCount":14,"threeStarCount":1,"twoHalfStarCount":9,"twoStarCount":0}',"performanceScore":0,"commentTotal":28,"commentPeople":0,"publicScorePeople":42,"performanceScorePeople":0,"searchHeat":0,"topDeadline":1642759685717,"showTime":1642175999999,"finishTime":1642262399999}},"succeed":!0,"msg":"success"},d={"code":200,"level":200,"message":"success","description":"","data":{"ranking":0,"type":null,"year":null,"dramaContent":{"dramaId":"6841299653275684903","title":"C-TEST-3","category":"movie","platform":"[]","coverImage":'["https://x0.ifengimg.com/ucms/2021_49/F20891B688163778017A9360FD2F39B5418C6A49_size508_w831_h503.png"]',"description":"12","publicScore":0,"publicScoreDistribution":'{"fiveStarCount":2,"fourStarCount":0,"oneStarCount":0,"threeStarCount":0,"twoStarCount":0}',"performanceScore":8,"commentTotal":2,"commentPeople":0,"publicScorePeople":2,"performanceScorePeople":4,"searchHeat":0,"topDeadline":1638789502507,"showTime":1638201599999,"finishTime":1639756799999}},"succeed":!0,"msg":"success"},m=function(){var e=Object(c.a)(r.a.mark((function _callee(e){var t,n;return r.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return n={},(t=s)&&200===t.code&&t.data&&(n=t.data),e.abrupt("return",n);case 4:case"end":return e.stop()}}),_callee)})));return function getDetailData(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(c.a)(r.a.mark((function _callee2(e){var t,n;return r.a.wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return n={},(t=d)&&200===t.code&&t.data&&(n=t.data),e.abrupt("return",n);case 4:case"end":return e.stop()}}),_callee2)})));return function getRankData(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(c.a)(r.a.mark((function _callee3(e,t){var n,a;return r.a.wrap((function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:return n=u.a.data,a=[],n&&200===n.code&&n.data&&n.data.list&&n.data.list.length>0&&(a=n.data.list),e.abrupt("return",a);case 4:case"end":return e.stop()}}),_callee3)})));return function getExpertsCommentData(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(c.a)(r.a.mark((function _callee4(e){var t,n,a;return r.a.wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(o.e)({"method":"POST","url":o.a+"/queryFriendCommentForPageWithGrade","data":{"body":{"sort":{},"pagination":{"current":1,"pageSize":4},"query":{"appId":i.b,"subjectId":e,"rootId":"0","queryNextRankComment":!0}}}});case 2:return t=r.sent,n=t.data,a=[],n&&200===n.code&&n.data&&n.data.list&&n.data.list.length>0&&(a=n.data.list),r.abrupt("return",a);case 7:case"end":return r.stop()}}),_callee4)})));return function getFriendCommendData(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(r.a.mark((function _callee5(e){var t,n,a=arguments;return r.a.wrap((function _callee5$(e){for(;;)switch(e.prev=e.next){case 0:return a.length>1&&void 0!==a[1]?a[1]:{},t=u.a.data,n=[],t&&200===t.code&&t.data&&t.data.list&&t.data.list.length>0&&(n=t.data.list),e.abrupt("return",n);case 5:case"end":return e.stop()}}),_callee5)})));return function getPublishCommentData(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(r.a.mark((function _callee6(e){var t,n,a;return r.a.wrap((function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(o.e)({"method":"GET","url":o.a+"/queryMovieGrade?movieId=".concat(e)});case 2:return t=r.sent,n=t.data,a={},n&&200===n.code&&n.data&&(a=n.data),r.abrupt("return",a);case 7:case"end":return r.stop()}}),_callee6)})));return function getMyScoreData(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(c.a)(r.a.mark((function _callee7(e){var t,n;return r.a.wrap((function _callee7$(e){for(;;)switch(e.prev=e.next){case 0:return n={},(t=l)&&200===t.code&&t.data&&(n=t.data),e.abrupt("return",n);case 4:case"end":return e.stop()}}),_callee7)})));return function getWorksData(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(c.a)(r.a.mark((function _callee8(e){return r.a.wrap((function _callee8$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.e)({"method":"POST","url":o.c+"/wind-vane-statistics/public/drama/log/collection/search-heat?dramaId=".concat(e)});case 2:case"end":return t.stop()}}),_callee8)})));return function sendHotWordCount(t){return e.apply(this,arguments)}}()},"311":function(e,t,n){e.exports={"evaluate":"index-module__evaluate___2ShPS","works":"index-module__works___1J7-p","img":"index-module__img___13ILQ","worksInfo":"index-module__worksInfo___2LT9Q","title":"index-module__title___1LDAR","time":"index-module__time___3Ig08","description":"index-module__description___3DGkY","rate":"index-module__rate___3Vu1N","rateNum":"index-module__rateNum___3t10E","tips":"index-module__tips___24Mxe","content":"index-module__content___20bV8","textWrap":"index-module__textWrap___3aU6q","textarea":"index-module__textarea___2nkoI","count":"index-module__count___3u3jc","checkboxWrap":"index-module__checkboxWrap___8smHq","checkbox":"index-module__checkbox___22J3E","image":"index-module__image___3LTBR","submit":"index-module__submit___mnpyW","submitBtn":"index-module__submitBtn___12FUL","unsubmitBtn":"index-module__unsubmitBtn___RKy8x"}},"312":function(e,t,n){e.exports={"netWork":"index-module__netWork___Ta3sE","offlineNet":"index-module__offlineNet___2XaWa","offlineIcon":"index-module__offlineIcon___3q__c","offlineNetText":"index-module__offlineNetText___zQTQh","retry":"index-module__retry___1EH8-"}},"416":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Evaluate}));n(0),n(5),n(4);var a=n(12),r=n(1),c=n(26),o=n(143),i=n(151),s=n.n(i),u=n(152),l=n(208),d=n(19),m=(n(29),n(21)),_=n(167),f=n(311),h=n.n(f),p=n(312),b=n.n(p),x=n(142);var j=function NetWork(e){return Object(x.jsx)(o.View,{"className":b.a.netWork,"children":Object(x.jsxs)(o.View,{"className":b.a.offlineNet,"children":[Object(x.jsx)(o.View,{"className":b.a.offlineIcon}),Object(x.jsx)(o.View,{"className":b.a.offlineNetText,"children":"连接失败，请检查网络"}),Object(x.jsx)(o.View,{"className":b.a.retry,"onClick":function handleRetry(){Object(r.showLoading)(),Object(r.getNetworkType)({"success":function success(t){Object(r.hideLoading)(),"none"===t.networkType?Object(r.showToast)({"title":"请检查网络连接","icon":"none","duration":2e3}):e.onRetry&&e.onRetry()},"fail":function fail(){Object(r.hideLoading)()}})},"children":"点击重试"})]})})},g=n(149),O=n(145),w=n.n(O).a.bind(h.a);function Evaluate(){var e=r.default.useRouter().params,t=e.worksId,n=e.score,i=void 0===n?0:n,f=e.content,p=void 0===f?"":f,b=e.type,O=void 0===b?"":b,v=e.commentId,k=e.subjectType,S=void 0===k?"default":k,y=Object(c.useState)(Number(i)),C=Object(a.a)(y,2),T=C[0],N=C[1],I=Object(c.useState)(p),D=Object(a.a)(I,2),E=D[0],B=D[1],P=Object(c.useState)(!1),V=Object(a.a)(P,2),L=V[0],F=V[1],H=Object(c.useState)(v),W=Object(a.a)(H,2),A=W[0],M=W[1],R=Object(c.useState)(null),z=Object(a.a)(R,2),U=z[0],$=z[1],q=Object(c.useState)(),G=Object(a.a)(q,2),Q=G[0],J=G[1],Y=Object(c.useState)(!0),X=Object(a.a)(Y,2),K=X[0],Z=X[1],ee=!1;function getData(e){Object(r.showLoading)({"title":"加载中"}),Object(l.g)(e).then((function(e){e&&($(null==e?void 0:e.dramaContent),Object(r.hideLoading)())})),Object(u.h)(e).then((function(e){var t;200===e.code?N((null===(t=e.data)||void 0===t?void 0:t.movieGrade)||0):Object(r.showToast)({"title":e.data.message,"icon":"none"})})).catch((function(e){console.error(e)})),Object(d.b)()&&Object(d.b)().getToken()&&Object(u.c)(e,S).then((function(e){200===e.code?(B(e.data.comment),M(e.data.id),F(0===e.data.showNameStatus)):404===e.code?B(""):Object(r.showToast)({"title":e.data.message})}))}return Object(c.useEffect)((function(){Object(r.getNetworkType)({"success":function success(e){J(e.networkType),"none"===e.networkType&&"unknown"===e.networkType||t&&getData(t)}})}),[t]),Object(x.jsxs)(o.View,{"className":h.a.evaluate,"children":[Object(x.jsx)(g.a,{"content":{"title":"我要评论","imageUrl":"https://x0.ifengimg.com/fe/custom/comment_bg.png","prevIcon":"https://x0.ifengimg.com/fe/ifengVane/icon_back.png","moreIcon":"https://x0.ifengimg.com/ucms/2021_47/F8097E8F89C929E2EDE42074519E4B35D8B418FC_size1_w96_h88.png","fizeColor":"#000"}}),Object(x.jsxs)(o.View,{"className":h.a.works,"children":["none"===Q?Object(x.jsx)(j,{"onRetry":function onRetry(){getData(t)}}):null,U?Object(x.jsx)(o.View,{"className":h.a.img,"children":Object(x.jsx)(o.Image,{"style":{"width":"106px","height":"148px","borderRadius":"8px","background":"#f2f2f2"},"src":JSON.parse(U.coverImage)[0]})}):null,U?Object(x.jsxs)(o.View,{"className":h.a.worksInfo,"children":[Object(x.jsx)(o.View,{"className":h.a.title,"children":U.title}),Object(x.jsxs)(o.View,{"className":h.a.time,"children":[s()(U.showTime).format("YYYY-MM-DD")," 上映"]}),Object(x.jsx)(o.View,{"className":h.a.description,"children":U.description})]}):null]}),Object(x.jsxs)(o.View,{"className":h.a.rate,"children":[Object(x.jsx)(o.View,{"className":h.a.rateNum,"children":Number(T).toFixed(1)}),Object(x.jsx)(_.a,{"score":T/2,"readonly":!1,"onChange":function onChange(e){N(2*e),K&&Z(!1)},"starSize":40,"margin":20}),Object(x.jsx)(o.View,{"className":h.a.tips,"children":"请点击星星进行评分"})]}),U?Object(x.jsx)(o.View,{"className":h.a.content,"children":Object(x.jsxs)(o.View,{"className":h.a.textWrap,"children":[Object(x.jsx)(o.Textarea,{"className":h.a.textarea,"placeholder":"好看吗，说说你的感受...","value":E,"onInput":function handleInput(e){B(e.detail.value),K&&Z(!1)},"maxlength":-1}),Object(x.jsx)(o.View,{"className":h.a.count,"style":{"color":E.length>500?"red":"#9e9e9e"},"children":"".concat(E.length,"/500")})]})}):null,U?Object(x.jsx)(o.View,{"className":h.a.submit,"children":Object(x.jsx)(o.Button,{"openType":"getUserProfile","className":w({"submitBtn":!0,"unsubmitBtn":K}),"onClick":function submit(){t?0!==T?E.length>500?Object(r.showToast)({"icon":"none","title":"超出字数限制，请您删减后重新提交！"}):!function isAuth(){return Object(d.b)()&&Object(d.b)().getToken()}()?function handleLogin(){Object(d.d)()}():function sendComment(){var e={"movieId":t||"","movieGrade":T};ee||(t&&"undefined"!==t?(ee=!0,Object(r.showLoading)(),Promise.all(A?[Object(u.l)(e),Object(u.m)({"id":A,"showNameStatus":L?0:1,"comment":E,"subjectId":t})]:[Object(u.l)(e),Object(u.a)({"rootId":0,"pId":0,"appId":m.b,"subjectId":t,"comment":E,"showNameStatus":L?0:1})]).then((function(e){e[0]&&e[1]||(Object(r.hideLoading)({"success":function success(){Object(r.showToast)({"title":"网络错误，请稍后再试","icon":"none"})}}),ee=!1),2===e.length&&(ee=!1),200===e[0].code&&Object(r.hideLoading)(),0===e[1].code&&Object(r.showToast)({"title":e[1].message,"icon":"none"}),200===e[1].code&&(Object(r.showToast)({"title":"评论成功","icon":"success"}),Object(r.setStorageSync)("comment",E),Object(r.setStorageSync)("latestComment",{"movieGrade":T,"comment":E,"subjectId":t,"commenUserName":Object(r.getStorageSync)("userInfo").nickName,"commentUserImgSrc":Object(r.getStorageSync)("userInfo").avatarUrl,"commentId":e[1].message,"isAnony":L}),r.default.redirectTo({"url":"/pages/subPages/evaluate/detail/index?score=".concat(T,"&worksId=").concat(t,"&commentId=").concat(e[1].message)}))})).catch((function(e){ee=!1,Object(r.hideLoading)(),console.log(e)}))):ee=!1)}():Object(r.showToast)({"title":"请您打完分后再提交","icon":"none"}):Object(r.showToast)({"title":"未找到该作品","icon":"none"})},"children":"edit"===O?"修改":"提交"})}):null]})}}}]);