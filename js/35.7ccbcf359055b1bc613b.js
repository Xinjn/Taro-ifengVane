(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"144":function(e,t,a){"use strict";a.d(t,"b",(function(){return m}));var n=a(5),o=a(10),c=a(11),r=a(20),s=a(15),i=a(16),l=a(6),u=a(26),d=a.n(u),p=a(142),_=function(e){Object(s.a)(ErrorBoundary,e);var t=Object(i.a)(ErrorBoundary);function ErrorBoundary(){var e;Object(o.a)(this,ErrorBoundary);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return e=t.call.apply(t,[this].concat(n)),Object(l.a)(Object(r.a)(e),"state",{"hasError":!1}),e}return Object(c.a)(ErrorBoundary,[{"key":"componentDidMount","value":function componentDidMount(){}},{"key":"componentDidCatch","value":function componentDidCatch(e,t){this.setState({"hasError":!0}),e.message="".concat(e.message," - componentStack: ").concat(t.componentStack),console.log("我是错误",e)}},{"key":"render","value":function render(){return this.state.hasError?"":this.props.children}}]),ErrorBoundary}(d.a.Component),m=function errorBoundary(e){return function(t){Object(s.a)(_class,t);var a=Object(i.a)(_class);function _class(){return Object(o.a)(this,_class),a.apply(this,arguments)}return Object(c.a)(_class,[{"key":"render","value":function render(){return Object(p.jsx)(_,{"children":Object(p.jsx)(e,Object(n.a)({},this.props))})}}]),_class}(d.a.PureComponent)};t.a=m},"149":function(e,t,a){"use strict";var n=a(0),o=a.n(n),c=a(4),r=a(1),s=a(26),i=a(143),l=a(150),u=a.n(l),d=a(144),p=a(142);t.a=Object(d.b)((function Header(e){var t=e.content,a=void 0===t?{}:t,n=a.type,l=void 0===n?"":n,d=a&&a.title||"",_=a&&a.imageUrl||"",m=a&&a.backgroundColor||"",h=a&&a.prevIcon||"",f=a&&a.moreIcon||"",x=a&&a.moreText||"",g=a&&a.fizeColor||"",j=a&&a.moreTextColor||g||"",b=r.default.getCurrentInstance();Object(s.useEffect)((function(){Object(r.pageScrollTo)({"scrollTop":0})}),[]);var O=function(){var t=Object(c.a)(o.a.mark((function _callee(){return o.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(!e.content.goBackHandle){t.next=3;break}return e.content.goBackHandle(),t.abrupt("return");case 3:if(!b.router.path.includes("back=home")){t.next=6;break}return r.default.reLaunch({"url":"/pages/index/index"}),t.abrupt("return",!1);case 6:if(!window||!window.grounds||"/pages/index/index"!==b.router.path&&"/pages/my/index"!==b.router.path&&"/pages/found/index"!==b.router.path){t.next=10;break}window.ground.close(),t.next=22;break;case 10:if("share"!==l){t.next=14;break}r.default.reLaunch({"url":"/pages/index/index"}),t.next=22;break;case 14:return t.prev=14,t.next=17,r.default.navigateBack({"delta":1});case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(14),r.default.reLaunch({"url":"/pages/index/index"});case 22:case"end":return t.stop()}}),_callee,null,[[14,19]])})));return function h5GoBackHandle(){return t.apply(this,arguments)}}(),v=_?{"backgroundImage":"url(".concat(_,")")}:{"backgroundColor":m};return Object(p.jsx)(i.View,{"className":u.a.headerBox,"style":v,"children":Object(p.jsxs)(i.View,{"className":u.a.header,"style":v,"children":[Object(p.jsx)(i.View,{"className":u.a.headerPrev,"children":h&&Object(p.jsx)(i.Image,{"onClick":O,"src":h,"mode":"aspectFit","className":u.a.headerPrevPic})}),Object(p.jsx)(i.View,{"className":u.a.headerTitle,"children":Object(p.jsx)(i.Text,{"className":u.a.headerTitleText,"style":{"color":g},"children":d})}),Object(p.jsxs)(i.View,{"className":u.a.headerMore,"children":[f&&Object(p.jsx)(i.Image,{"src":f,"mode":"aspectFit","onClick":function moreIconHandle(){if(window&&window.grounds)try{window.grounds.openShare(location.href,"凤娱指数-影剧综榜单","凤凰新闻","https://x0.ifengimg.com/ucms/2021_50/42603B06AF7D0F555A12FC2E60ED0C61CFDB9709_size27_w432_h432.png","brand_mxdb01")}catch(e){try{window.grounds.openShare(location.href,"凤娱指数-影剧综榜单","凤凰新闻","https://x0.ifengimg.com/ucms/2021_50/42603B06AF7D0F555A12FC2E60ED0C61CFDB9709_size27_w432_h432.png","brand_mxdb01","")}catch(e){}}},"className":u.a.headerMorePic}),e.children,x&&Object(p.jsx)(i.Text,{"className":u.a.headerMoreText,"onClick":function moreTextHandle(){e.content.moreTextHandle()},"style":{"color":j},"children":x})]})]})})}))},"150":function(e,t,a){e.exports={"headerBox":"index-module__headerBox___1_u1D","headerBoxWx":"index-module__headerBoxWx___3wJqw","header":"index-module__header___6NxCV","headerWx":"index-module__headerWx___3y-VP","headerPrev":"index-module__headerPrev___12MB1","headerPrevPic":"index-module__headerPrevPic___212ke","headerTitle":"index-module__headerTitle___25jwe","headerTitleText":"index-module__headerTitleText___3LAcX","headerMore":"index-module__headerMore___2nNrE","headerMorePic":"index-module__headerMorePic___ydU02","headerMoreText":"index-module__headerMoreText___fvvfk"}},"337":function(e,t,a){e.exports={"pageBody":"index-module__pageBody___3y9Mg","area":"index-module__area___1Y0zG","view":"index-module__view___x2fK3","myhandle":"index-module__myhandle___JDEkX","listWrap":"index-module__listWrap___3hf2k","opusFeed":"index-module__opusFeed____vVuX","active":"index-module__active___BqYF4","opusOption":"index-module__opusOption___pknM6","opusActive":"index-module__opusActive___3ldzX","opusImg":"index-module__opusImg___2EAa8","opusTitle":"index-module__opusTitle___3DbHt","opusFeedRight":"index-module__opusFeedRight___3ARqV","activeRight":"index-module__activeRight___1wsbU","opusTitleText":"index-module__opusTitleText___3huIe","opusMenu":"index-module__opusMenu___j6ywT"}},"339":function(e,t,a){e.exports={"addOpus":"index-module__addOpus___3WiPP","addOpusText":"index-module__addOpusText___nOweF","wrap":"index-module__wrap___3QXSX","noWrap":"index-module__noWrap___CPXOU","noData":"index-module__noData___3qR2s","noDataImage":"index-module__noDataImage___2t2Xc","noDataText":"index-module__noDataText___1e5lD"}},"345":function(e,t,a){e.exports={"pageBody":"index-module__pageBody___3R8l_","area":"index-module__area___1ixpO","view":"index-module__view___2TlnN","myhandle":"index-module__myhandle___nCSIg","opusFeed":"index-module__opusFeed___2_Fj7","opusOption":"index-module__opusOption___1B29E","opusActive":"index-module__opusActive___3s0BK","opusImgWrap":"index-module__opusImgWrap___3HenU","opusImg":"index-module__opusImg___1Ydhq","opusTitle":"index-module__opusTitle___j0qAd","opusFeedRight":"index-module__opusFeedRight___3Comu","activeRight":"index-module__activeRight___2ahmM","opusTitleText":"index-module__opusTitleText___3baTZ","opusMenu":"index-module__opusMenu___2CzER","moveArea":"index-module__moveArea___19usu","moveView":"index-module__moveView___3-8Oc"}},"346":function(e,t,a){e.exports={"operateBox":"index-module__operateBox___3jG6W","operate":"index-module__operate___1i1jv","operateAll":"index-module__operateAll___2WEOW","operateLine":"index-module__operateLine___1QQVl","operateDelete":"index-module__operateDelete___34Is9","operateDeleteActive":"index-module__operateDeleteActive___3POu_"}},"347":function(e,t,a){e.exports={"wrap":"index-module__wrap___n6ux_"}},"348":function(e,t,a){e.exports={"site":"index-module__site___gT3DQ","wrap":"index-module__wrap___2QhTS","recommend":"index-module__recommend___3Y01j","addAndSave":"index-module__addAndSave___1jdJa","add":"index-module__add___176xF"}},"403":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return OpusManage}));var n=a(12),o=a(26),c=a(5),r=a(0),s=a.n(r),i=a(4),l=a(14),u=a(143),d=a(337),p=a.n(d),_=a(338),m=(Object(_.a)((function useStore(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.useState)(e),a=Object(n.a)(t,2),c=a[0],r=a[1],s=function changeStates(e){r((function(t){return Object.assign({},t,e)}))};return{"states":c,"changeStates":s}})),Object(_.a)((function useListStore(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"listId":"","initOpusFeedList":[],"opusFeedList":[],"pagination":{}},t=Object(o.useState)(e),a=Object(n.a)(t,2),c=a[0],r=a[1],s=function changeListStates(e){r((function(t){return Object.assign({},t,e)}))};return{"listStates":c,"changeListStates":s}}))),h=a(339),f=a.n(h),x=a(45),g=a(142);function AddOpusBotton(e){var t=e.listId,a=m.useContainer(),n=a.listStates,o=(a.changeListStates,n.opusFeedList);return Object(g.jsxs)(u.View,{"className":"".concat(f.a.wrap," ").concat(0===o.length&&f.a.noWrap),"children":[0===o.length&&Object(g.jsxs)(u.View,{"className":f.a.noData,"children":[Object(g.jsx)(u.Image,{"className":f.a.noDataImage,"src":"https://x0.ifengimg.com/ucms/2022_23/2F787633DD4F7E97187EC015DF34467741CF156E_size32_w360_h360.png "}),Object(g.jsx)(u.View,{"className":f.a.noDataText,"children":"此单片暂无作品"})]}),Object(g.jsx)(u.View,{"className":f.a.addOpus,"onClick":function handleAddOpus(){Object(x.e)("/pages/subPages/addOpus/index?listId=".concat(t))},"children":Object(g.jsx)(u.Text,{"className":f.a.addOpusText,"children":"添加作品"})})]})}var j,b,O=a(392),v=a(1),w=a(13),T={"code":200,"level":200,"message":"success","description":"","data":{"pagination":{"current":1,"pageSize":10,"total":6,"start":0},"list":[{"dramaId":"6841299661978865683","title":"测试谁是谁","category":"variety","platform":'["芒果TV"]',"coverImage":'["https://x0.ifengimg.com/ucms/2022_25/CF92724AE2B8A857465229A93DA57C2CF894B5F2_size93_w487_h681.jpg"]',"publicScore":4.5,"performanceScore":0,"commentTotal":2,"commentPeople":0,"publicScorePeople":162,"performanceScorePeople":0,"searchHeat":0,"showTime":1655135999999,"hasParticipated":!1,"description":"定时发送到发送到发送到发的风"},{"dramaId":"6874236891051335720","title":"神仙姐姐","category":"tv-play","platform":'["优酷视频"]',"coverImage":'["https://x0.ifengimg.com/ucms/2022_25/433D697B04AE782D4E6D646B8DEEFA1C6C9CEA2E_size247_w1080_h1512.jpg"]',"publicScore":0,"performanceScore":0,"commentTotal":28,"commentPeople":0,"publicScorePeople":42,"performanceScorePeople":0,"searchHeat":0,"showTime":1642175999999,"hasParticipated":!1,"description":"神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐神仙姐姐"},{"dramaId":"6841299653275684906","title":"C-TEST","category":"movie","platform":"[]","coverImage":'["https://x0.ifengimg.com/ucms/2021_49/F20891B688163778017A9360FD2F39B5418C6A49_size508_w831_h503.png"]',"publicScore":0,"performanceScore":7.6875,"commentTotal":3,"commentPeople":0,"publicScorePeople":5,"performanceScorePeople":16,"searchHeat":0,"showTime":1638201599999,"hasParticipated":!1,"description":"1"},{"dramaId":"6841299653275684905","title":"C-TEST-2","category":"movie","platform":"[]","coverImage":'["https://x0.ifengimg.com/ucms/2021_49/F20891B688163778017A9360FD2F39B5418C6A49_size508_w831_h503.png"]',"publicScore":0,"performanceScore":9,"commentTotal":3,"commentPeople":0,"publicScorePeople":6,"performanceScorePeople":1,"searchHeat":12,"showTime":1638201599999,"hasParticipated":!1,"description":"1"},{"dramaId":"6923116002918014978","title":"222作品测试测试作品测试测试作品测试测试哈哈哈哈哈哈哈","category":"tv-play","platform":"[]","coverImage":'["https://x0.ifengimg.com/ucms/2022_25/EC908D3F7CD03F44AC2E14CF2A13F5A6B3AC8339_size138_w296_h350.png"]',"publicScore":4.5,"performanceScore":0,"commentTotal":22,"commentPeople":0,"publicScorePeople":176,"performanceScorePeople":0,"searchHeat":0,"showTime":1650988799999,"hasParticipated":!1,"description":"这是宋仲基club!!!!!!!!1"},{"dramaId":"6841299653275684903","title":"C-TEST-3","category":"movie","platform":"[]","coverImage":'["https://x0.ifengimg.com/ucms/2021_49/F20891B688163778017A9360FD2F39B5418C6A49_size508_w831_h503.png"]',"publicScore":0,"performanceScore":8,"commentTotal":2,"commentPeople":0,"publicScorePeople":2,"performanceScorePeople":4,"searchHeat":0,"showTime":1638201599999,"hasParticipated":!1,"description":"12"}]},"succeed":!0,"msg":"success"},y=Object(v.getStorageSync)("token")||(null===(j=window.grounds)||void 0===j||null===(b=j.getUserInfo())||void 0===b?void 0:b.getToken());y=y?"Bearer ".concat(y):"";var S=function(){var e=Object(i.a)(s.a.mark((function _callee3(e){var t,a;return s.a.wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return e.obj,a={},(t=T)&&200===t.code&&t.data&&(a=t.data),n.abrupt("return",a);case 5:case"end":return n.stop()}}),_callee3)})));return function listDramas(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(i.a)(s.a.mark((function _callee4(e){var t,a,n,o;return s.a.wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.listId,a=e.deleteArr,c.next=3,Object(w.e)({"method":"PUT","data":{"body":a},"header":{"content-type":"application/json","Authorization":y},"url":w.c+"/wind-vane-portal/user/list/deleteDramas/".concat(t)});case 3:return n=c.sent,o=n.data,{},o&&200===o.code&&o.data&&o.data,c.abrupt("return",o);case 8:case"end":return c.stop()}}),_callee4)})));return function deleteDramas(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(i.a)(s.a.mark((function _callee5(e){var t,a,n,o,c;return s.a.wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.listId,a=e.obj,console.log("更新列表",a),r.next=4,Object(w.e)({"method":"PUT","data":{"body":a},"header":{"content-type":"application/json","Authorization":y},"url":w.c+"/wind-vane-portal/user/drama/upsertDramas/".concat(t)});case 4:return n=r.sent,o=n.data,console.log("更新数据",o),c={},o&&200===o.code&&o.data&&(c=o.data),r.abrupt("return",c);case 10:case"end":return r.stop()}}),_callee5)})));return function upsertDramas(t){return e.apply(this,arguments)}}();function OpusFeed(e){var t=e.listId,a=m.useContainer(),r=a.listStates,d=a.changeListStates,_=r.opusFeedList,h=r.pagination,f=h.current,x=h.pageSize,j=h.total,b=Object(o.useState)(!0),w=Object(n.a)(b,2),T=w[0],y=w[1],F=Object(o.useState)([]),I=Object(n.a)(F,2),k=I[0],E=I[1];Object(o.useEffect)((function(){E(Object(l.a)(_))}),[_]);var C=function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a,n,o,c,r,i;return s.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!(x*f<j)){s.next=15;break}return console.log("加载更多"),s.prev=2,e={"pagination":{"pageSize":10,"current":f},"query":{"listId":t},"sort":{"type":"asc","key":"update_time"}},s.next=6,S({"obj":e});case 6:(null==(a=s.sent)?void 0:a.list.length)>0&&(a.list.forEach((function(e,t){e.choose=!1,e.id=t,e.height=100,e.y=0})),h.current=h.current+1,n=_.concat(a.list),console.log("opusFeedList2",n),d({"opusFeedList":n,"pagination":h})),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(2),console.log("error",s.t0);case 13:s.next=34;break;case 15:if(console.log("到底"),_.length!==j){s.next=20;break}y(!1),s.next=34;break;case 20:return o=j-_.length,console.log("num",o),s.prev=22,c={"pagination":{"pageSize":o,"current":f},"query":{"listId":t},"sort":{"type":"asc","key":"update_time"}},s.next=26,S({"obj":c});case 26:(null==(r=s.sent)?void 0:r.list.length)>0&&(r.list.forEach((function(e,t){e.choose=!1,e.id=t,e.height=100,e.y=0})),h.current=h.current+1,i=_.concat(r.list),console.log("opusFeedList2",i),d({"opusFeedList":i,"pagination":h})),s.next=33;break;case 30:s.prev=30,s.t1=s.catch(22),console.log("error",s.t1);case 33:y(!1);case 34:case"end":return s.stop()}}),_callee,null,[[2,10],[22,30]])})));return function loadMoreData(){return e.apply(this,arguments)}}();return v.default.useReachBottom((function(){if(!T)return!1;C()})),Object(g.jsxs)(u.View,{"className":p.a.pageBody,"children":[k.length>0&&Object(g.jsx)(O.a,{"onDragEnd":function onDragEnd(e){if(e.destination){var t=function reorder(e,t,a){var o=Array.from(e),c=o.splice(t,1),r=Object(n.a)(c,1)[0];return o.splice(a,0,r),d({"opusFeedList":Object(l.a)(o)}),o}(k,e.source.index,e.destination.index);E(t)}},"children":Object(g.jsx)(O.c,{"droppableId":"droppable","children":function children(e,t){return Object(g.jsxs)(u.View,Object(c.a)(Object(c.a)({},e.droppableProps),{},{"ref":e.innerRef,"className":p.a.listWrap,"children":[k.length>0&&k.map((function(e,t){return Object(g.jsx)(O.b,{"draggableId":null==e?void 0:e.dramaId,"index":t,"children":function children(t,a){return Object(g.jsx)(u.View,Object(c.a)(Object(c.a)(Object(c.a)({"ref":t.innerRef},t.draggableProps),t.dragHandleProps),{},{"onClick":function onClick(){return function handleToggleItem(e){var t=_,a=t.find((function(t){return(null==t?void 0:t.dramaId)===(null==e?void 0:e.dramaId)}));a.choose=!a.choose,d({"opusFeedList":Object(l.a)(t)})}(e)},"className":p.a.item,"children":Object(g.jsxs)(u.View,{"className":"".concat(p.a.opusFeed," ").concat(a.isDragging?p.a.active:""),"children":[Object(g.jsx)(u.View,{"className":"".concat(p.a.opusOption," ").concat(null!=e&&e.choose?p.a.opusActive:"")}),Object(g.jsxs)(u.View,{"className":"".concat(p.a.opusFeedRight," ").concat(a.isDragging?p.a.activeRight:""),"children":[Object(g.jsx)(u.Image,{"className":p.a.opusImg,"mode":"aspectFit","src":"https://d.ifengimg.com/w130_h180_q100/x0.ifengimg.com/ucms/2022_18/9403A8969E80F05B1B194EB71E28EBB99BA22850_size165_w731_h1024.jpg"}),Object(g.jsx)(u.View,{"className":p.a.opusTitle,"children":Object(g.jsx)(u.Text,{"className":p.a.opusTitleText,"children":null==e?void 0:e.title})}),Object(g.jsx)(u.View,{"className":"".concat(p.a.opusMenu," handler")})]})]})}))}},null==e?void 0:e.dramaId)})),e.placeholder]}))}})}),Object(g.jsx)(AddOpusBotton,{"listId":t})]})}var k=a(345),E=a.n(k);function opusFeed3(e){var t=e.listId,a=m.useContainer(),c=a.listStates,r=a.changeListStates,d=c.opusFeedList,p=c.pagination,_=p.current,h=p.pageSize,f=p.total,x=Object(o.useState)(!0),j=Object(n.a)(x,2),b=j[0],O=j[1],w=Object(o.useState)(!1),T=Object(n.a)(w,2),y=T[0],F=T[1],I=Object(o.useState)(-1),k=Object(n.a)(I,2),C=k[0],B=k[1],D=Object(o.useState)([]),N=Object(n.a)(D,2),A=N[0],P=N[1],L=Object(o.useState)(0),V=Object(n.a)(L,2),M=V[0],z=V[1];Object(o.useEffect)((function(){var e=d;e.forEach((function(e,t){e.y=100*t})),P(Object(l.a)(e))}),[d]),Object(o.useEffect)((function(){var e=A.length;z(100*e)}),[A]);var H=function onTouchMove(e){},R=function onTouchEnd(e,t){if(console.log("onTouchEnd","是否拖拽：",y),y){var a=Object(v.createSelectorQuery)();a.select(".demoDOM_".concat(t)).boundingClientRect(),a.selectViewport().scrollOffset(),a.exec((function(e){var a=e[0].top,o=e[1].scrollTop;console.log("当前索引",t);var c=Math.round(a/100);console.log("updateIndex",c);var s=Math.round(o/100);console.log("listOutIndex",s);var i=c+s-1;if(console.log("moveIndex",i),i===t){console.log("不替换");var u=JSON.parse(JSON.stringify(A)),d=u.splice(t,1),p=Object(n.a)(d,1)[0];P(Object(l.a)(u)),setTimeout((function(){JSON.parse(JSON.stringify(A)).splice(t,0,p),P(Object(l.a)(A))}),10)}else{console.log("替换");var _=function reorder(e,t,a){var o=Array.from(e),c=o.splice(t,1),r=Object(n.a)(c,1)[0];return o.splice(a,0,r),o}(A,t,i);_.forEach((function(e,t){e.y=100*t})),r({"opusFeedList":Object(l.a)(_)})}})),F(!1),B(-1)}},W=function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a,n,o,c,i,l;return s.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!(h*_<f)){s.next=15;break}return console.log("加载更多"),s.prev=2,e={"pagination":{"pageSize":10,"current":_},"query":{"listId":t},"sort":{"type":"asc","key":"update_time"}},s.next=6,S({"obj":e});case 6:(null==(a=s.sent)?void 0:a.list.length)>0&&(a.list.forEach((function(e,t){e.choose=!1,e.id=t,e.height=100,e.y=100*t})),p.current=p.current+1,(n=d.concat(a.list)).forEach((function(e,t){e.y=100*t})),r({"opusFeedList":n,"pagination":p})),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(2),console.log("error",s.t0);case 13:s.next=34;break;case 15:if(console.log("到底"),d.length!==f){s.next=20;break}O(!1),s.next=34;break;case 20:return o=f-d.length,console.log("num",o),s.prev=22,c={"pagination":{"pageSize":o,"current":_},"query":{"listId":t},"sort":{"type":"asc","key":"update_time"}},s.next=26,S({"obj":c});case 26:(null==(i=s.sent)?void 0:i.list.length)>0&&(i.list.forEach((function(e,t){e.choose=!1,e.id=t,e.height=100,e.y=100*t})),p.current=p.current+1,(l=d.concat(i.list)).forEach((function(e,t){e.y=100*t})),r({"opusFeedList":l,"pagination":p})),s.next=33;break;case 30:s.prev=30,s.t1=s.catch(22),console.log("error",s.t1);case 33:O(!1);case 34:case"end":return s.stop()}}),_callee,null,[[2,10],[22,30]])})));return function loadMoreData(){return e.apply(this,arguments)}}();v.default.useReachBottom((function(){if(!b)return!1;W()}));return Object(g.jsx)(u.View,{"className":E.a.pageBody,"children":Object(g.jsx)(u.MovableArea,{"style":{"height":M,"width":"100%"},"className":"".concat(E.a.moveArea),"children":A.map((function(e,t){return Object(g.jsx)(u.MovableView,{"style":{"width":"100%","height":e.height,"zIndex":t===C?2:1,"backgroundColor":t===C?"#fff":""},"className":"".concat(E.a.moveView," demoDOM_").concat(t," "),"direction":"vertical","x":0,"y":e.y,"onLongPress":function onLongPress(e){return function onLongPress(e,t){console.log("longPress"),B(t),F(!0)}(0,t)},"onTouchStart":function onTouchStart(e){return function onTouchStart(e){e.preventDefault()}(e)},"onTouchMove":H,"onTouchEnd":function onTouchEnd(e){return R(0,t)},"animation":!1,"disabled":!y,"children":Object(g.jsx)(u.View,{"onClick":function onClick(){return function handleToggleItem(e){var t=d;t.forEach((function(t,a){e===a&&(t.choose=!t.choose)})),r({"opusFeedList":Object(l.a)(t)})}(t)},"className":E.a.item,"children":Object(g.jsxs)(u.View,{"className":"".concat(E.a.opusFeed," "),"children":[Object(g.jsx)(u.View,{"className":"".concat(E.a.opusOption," ").concat(e.choose?E.a.opusActive:"")}),Object(g.jsxs)(u.View,{"className":"".concat(E.a.opusFeedRight),"style":{"borderBottom":t===C?"":"1px solid #E8E8E8"},"children":[Object(g.jsx)(u.View,{"className":E.a.opusImgWrap,"children":Object(g.jsx)(u.Image,{"className":E.a.opusImg,"mode":"aspectFill","src":JSON.parse(null==e?void 0:e.coverImage)[0]})}),Object(g.jsx)(u.View,{"className":E.a.opusTitle,"children":Object(g.jsx)(u.Text,{"className":E.a.opusTitleText,"children":null==e?void 0:e.title})}),Object(g.jsx)(u.View,{"className":"".concat(E.a.opusMenu," handler")})]})]})})},"".concat(e.dramaId,"_").concat(t))}))})})}var C=a(346),B=a.n(C);function Operate(e){var t=e.listId,a=m.useContainer(),c=a.listStates,r=a.changeListStates,d=c.opusFeedList,p=Object(o.useState)(!1),_=Object(n.a)(p,2),h=_[0],f=_[1],x=Object(o.useState)(0),j=Object(n.a)(x,2),b=j[0],O=j[1],w=function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a,n,o;return s.a.wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,e=JSON.parse(JSON.stringify(d)),a=[],e.forEach((function(e){!0===e.choose&&a.push(e.dramaId)})),console.log("删除作品集合",a),c.next=7,F({"listId":t,"deleteArr":a});case 7:n=c.sent,console.log("删除作品",n),o=e.filter((function(e){return!1===e.choose})),r({"opusFeedList":Object(l.a)(o),"initOpusFeedList":Object(l.a)(o)}),f(!1),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(0),console.log(c.t0);case 17:case"end":return c.stop()}}),_callee,null,[[0,14]])})));return function deleteConfire(){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){!function getChoose(){var e=0;d.map((function(t){t.choose&&e++})),O(e)}()}),[d]),Object(g.jsx)(u.View,{"className":B.a.operateBox,"children":Object(g.jsxs)(u.View,{"className":B.a.operate,"children":[Object(g.jsx)(u.View,{"className":B.a.operateAll,"onClick":function handlerAll(){if(0!==d.length){f(!h);var e=d;h?e.forEach((function(e){return e.choose=!1})):e.forEach((function(e){return e.choose=!0})),r({"opusFeedList":Object(l.a)(e)})}},"children":h?Object(g.jsx)(u.Text,{"children":"取消全选"}):Object(g.jsx)(u.Text,{"children":"全选"})}),Object(g.jsx)(u.View,{"className":B.a.operateLine}),Object(g.jsx)(u.View,{"className":"".concat(B.a.operateDelete," ").concat(b&&B.a.operateDeleteActive),"onClick":function handlerDelete(){0!==b&&Object(v.showModal)({"content":"确认删除选中内容吗？","cancelColor":"#9E9E9E","cancelText":"取消","confirmText":"确认","confirmColor":"#F54343","success":function success(e){e.confirm?w():e.cancel&&console.log("用户点击取消")}})},"children":b?Object(g.jsxs)(u.Text,{"children":["删除(",b,")"]}):Object(g.jsx)(u.Text,{"children":"删除"})})]})})}var D=a(347),N=a.n(D);function Wrap(e){var t=e.listId,a=m.useContainer(),n=a.listStates,c=a.changeListStates,r=(n.initOpusFeedList,function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a;return s.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e={"pagination":{"pageSize":10,"current":1},"query":{"listId":t},"sort":{"type":"asc","key":"update_time"}},n.next=4,S({"obj":e});case 4:(null==(a=n.sent)?void 0:a.list.length)>0&&(a.list.forEach((function(e,t){e.choose=!1,e.id=t,e.height=100,e.y=100*t})),console.log("查询片单作品并处理",a),a.pagination.current=a.pagination.current+1,c({"initOpusFeedList":a.list,"opusFeedList":a.list,"pagination":a.pagination})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("error",n.t0);case 11:case"end":return n.stop()}}),_callee,null,[[0,8]])})));return function fetchList(){return e.apply(this,arguments)}}());return Object(o.useEffect)((function(){r()}),[]),v.default.useDidShow((function(){r()})),Object(g.jsx)(u.View,{"className":N.a.wrap,"children":e.children})}var A=a(149);function Header(e){var t=e.listId,a=m.useContainer(),n=a.listStates,o=a.changeListStates,c=n.opusFeedList,r=n.initOpusFeedList,u=(v.default.getCurrentInstance(),function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a;return s.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e=[],o({"initOpusFeedList":Object(l.a)(c)}),c.map((function(t,a){e.push({"dramaId":null==t?void 0:t.dramaId,"position":a+1})})),a={"dataList":e},n.next=7,I({"listId":t,"obj":a});case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0);case 12:case"end":return n.stop()}}),_callee,null,[[0,9]])})));return function onSave(){return e.apply(this,arguments)}}()),d=function(){var e=Object(i.a)(s.a.mark((function _callee2(){return s.a.wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:Object(x.e)("/pages/my/index?tab=1","close");case 1:case"end":return e.stop()}}),_callee2)})));return function h5GoBackHandle(){return e.apply(this,arguments)}}(),p={"title":"作品管理","imageUrl":"https://x0.ifengimg.com/fe/custom/comment_bg.png","prevIcon":"https://x0.ifengimg.com/fe/ifengVane/icon_back.png","fizeColor":"#000","moreTextHandle":function moreTextHandle(){Object(v.showModal)({"content":"是否保存本次操作","cancelColor":"#9E9E9E","cancelText":"不保存","confirmText":"保存","confirmColor":"#F54343","success":function success(e){e.confirm?u():e.cancel&&console.log("用户点击取消")}})},"goBackHandle":function goBackHandle(){for(var e in r)if(c[e]!==r[e])return console.log("noSave"),void Object(v.showModal)({"content":"有未确认的修改，离开不会保存","cancelColor":"#9E9E9E","cancelText":"取消","confirmText":"确认离开","confirmColor":"#F54343","success":function success(e){e.confirm?(console.log("用户点击确定"),d()):e.cancel&&console.log("用户点击取消")}});d()}};return Object(g.jsx)(A.a,{"content":p})}var P=a(348),L=a.n(P);function Filter(e){var t=e.listId,a=m.useContainer(),n=a.listStates,o=a.changeListStates,c=n.opusFeedList,r=(n.initOpusFeedList,function(){var e=Object(i.a)(s.a.mark((function _callee(){var e,a;return s.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e=[],o({"initOpusFeedList":Object(l.a)(c)}),c.map((function(t,a){e.push({"dramaId":null==t?void 0:t.dramaId,"position":a+1})})),a={"dataList":e},n.next=7,I({"listId":t,"obj":a});case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0);case 12:case"end":return n.stop()}}),_callee,null,[[0,9]])})));return function onSave(){return e.apply(this,arguments)}}());return Object(g.jsx)(u.View,{"className":L.a.site,"children":Object(g.jsxs)(u.View,{"className":L.a.wrap,"children":[Object(g.jsx)(u.View,{"className":L.a.recommend,"children":"热门推荐"}),Object(g.jsxs)(u.View,{"className":L.a.addAndSave,"children":[Object(g.jsx)(u.View,{"className":L.a.add,"onClick":function handleAddOpus(){Object(x.e)("/pages/subPages/addOpus/index?listId=".concat(t))},"children":"添加作品"}),Object(g.jsx)(u.View,{"className":L.a.save,"onClick":function moreTextHandle(){Object(v.showModal)({"content":"是否保存本次操作","cancelColor":"#9E9E9E","cancelText":"不保存","confirmText":"保存","confirmColor":"#F54343","success":function success(e){e.confirm?r():e.cancel&&console.log("用户点击取消")}})},"children":"保存"})]})]})})}function OpusManage(){var e=v.default.useRouter().params.listId,t=void 0===e?"":e,a=Object(o.useState)(""),c=Object(n.a)(a,2),r=c[0],s=c[1];return Object(o.useEffect)((function(){s("other"),console.log("other")}),[]),Object(g.jsx)(m.Provider,{"children":Object(g.jsxs)(Wrap,{"listId":t,"children":[Object(g.jsx)(Header,{"listId":t}),Object(g.jsx)(Filter,{"listId":t}),"other"===r&&Object(g.jsx)(OpusFeed,{"listId":t}),"weapp"===r&&Object(g.jsx)(opusFeed3,{"listId":t}),Object(g.jsx)(Operate,{"listId":t})]})})}}}]);