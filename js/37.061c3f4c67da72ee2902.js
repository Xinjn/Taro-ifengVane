(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"226":function(e,t,c){"use strict";c(26);var a=c(143),o=c(235),n=c.n(o),r=c(142);t.a=function Content(e){var t=e.text,c=e.gotoNew,o=e.btnText,s=e.flag,i=e.current;return Object(r.jsxs)(a.View,{"className":n.a.headBox,"children":[Object(r.jsx)(a.View,{"className":n.a.introduce,"children":t}),Object(r.jsx)(a.View,{"className":s?i?"".concat(n.a.btn):"".concat(n.a.btn," ").concat(n.a.nobtn):"".concat(n.a.btn),"onClick":c,"children":o})]})}},"235":function(e,t,c){e.exports={"headBox":"index-module__headBox___3iPax","introduce":"index-module__introduce___2mNxl","btn":"index-module__btn___2xps0","nobtn":"index-module__nobtn___4ewFG"}},"349":function(e,t,c){e.exports={"pageBody":"index-module__pageBody___1IY78","add":"index-module__add___QWsnO","current":"index-module__current___3nb4Z"}},"350":function(e,t,c){e.exports={"hotRecommed":"index-module__hotRecommed___h4-Z1","resultTitle":"index-module__resultTitle___1csXU","noSearchResult":"index-module__noSearchResult___7e187","noSearchIcon":"index-module__noSearchIcon___2QjhC","noSearchText":"index-module__noSearchText___1BPD4"}},"351":function(e,t,c){e.exports={"hotRecommedItem":"index-module__hotRecommedItem___2tdmm","hotRecommedImage":"index-module__hotRecommedImage___1nafk","hotRecommedText":"index-module__hotRecommedText___2U1IS","hotRecommedSeriesTitle":"index-module__hotRecommedSeriesTitle___1XfT2","hotRecommedSeries":"index-module__hotRecommedSeries___2wVQx","hotRecommedSeriesLeft":"index-module__hotRecommedSeriesLeft___2-Wc2","hotRecommedSeriesRight":"index-module__hotRecommedSeriesRight___4bCWE","hotRecommedSeriesMark":"index-module__hotRecommedSeriesMark___6-9GF","hotRecommedSeriesMarkText":"index-module__hotRecommedSeriesMarkText___2vEPc","hotRecommedSeriesScore1":"index-module__hotRecommedSeriesScore1___3Dnu8","hotRecommedSeriesScore2":"index-module__hotRecommedSeriesScore2___gHJY2","hotRecommedSeriesCrow":"index-module__hotRecommedSeriesCrow___WlhvJ","hotRecommedCrowScore":"index-module__hotRecommedCrowScore___9YR3E","hotRecommedCrowScoreNo":"index-module__hotRecommedCrowScoreNo___32TUh","hotRecommedSeriesInfo":"index-module__hotRecommedSeriesInfo___3d4KG","hotRecommedSeriesText":"index-module__hotRecommedSeriesText___1VQ15","selectIcon":"index-module__selectIcon___18T8r","selectIconActive":"index-module__selectIconActive___1mdnE"}},"352":function(e,t,c){e.exports={"hotRecommed":"index-module__hotRecommed___6vU4y","hotRecommedTitle":"index-module__hotRecommedTitle___2ZDnW"}},"410":function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return AddOpus}));var a=c(14),o=c(0),n=c.n(o),r=c(4),s=c(12),i=c(1),d=c(26),l=c(143),m=c(349),u=c.n(m),h=c(149),_=c(224),x=c(240),j=c(350),b=c.n(j),f=c(5),O=c(172),S=c(351),p=c.n(S),w=c(45),R=c(144),g=c(171),I=c(142),v=Object(R.a)((function SearchFeed(e){var t=e.feedData,c=e.isFromSourch,a=e.handleSelect,o=Object(d.useState)([]),n=Object(s.a)(o,2),r=n[0],i=n[1];return Object(d.useEffect)((function(){var e=t.map((function(e){return Object(f.a)({},e)}));i(e)}),[t]),r&&r.length>0&&Object(I.jsx)(l.View,{"className":p.a.hotRecommedList,"children":r.map((function(e,t){var o=e.showTime&&new Date(parseInt(e.showTime)),n=e.showTime&&o.getFullYear(),s=e.showTime&&o.getMonth()+1,d=e.showTime&&o.getDate(),m=e.showTime?"".concat(n,"-").concat(s,"-").concat(d):"",u=e.category&&g.a[e.category]||"",h=e.coverImage&&JSON.parse(e.coverImage)&&JSON.parse(e.coverImage)[0]&&Object(O.a)(JSON.parse(e.coverImage)[0],130,180,100)||"";c?"/pages/subPages/detail/index?dramaId=".concat(e.dramaId,"&isFromSourch=1&shareLine=id-").concat(e.dramaId,"!type-ch"):"/pages/subPages/detail/index?dramaId=".concat(e.dramaId,"&shareLine=id-").concat(e.dramaId,"!type-ch");return Object(I.jsxs)(l.View,{"className":p.a.hotRecommedItem,"onClick":function onClick(){!function selectHandle(e){var t=JSON.parse(JSON.stringify(r));t[e].existFlag=!r[e].existFlag,i(t),a(t[e],t)}(t)},"children":[Object(I.jsx)(l.View,{"className":"".concat(p.a.selectIcon," ").concat(e.existFlag?p.a.selectIconActive:"")}),Object(I.jsx)(l.Image,{"mode":"aspectFit","src":h,"className":p.a.hotRecommedImage}),Object(I.jsxs)(l.View,{"className":p.a.hotRecommedText,"children":[Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeries,"children":[Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesLeft,"children":[Object(I.jsx)(l.View,{"className":p.a.hotRecommedSeriesTitle,"children":e.title}),u&&Object(I.jsx)(l.View,{"className":p.a.hotRecommedSeriesMark,"children":Object(I.jsx)(l.Text,{"className":p.a.hotRecommedSeriesMarkText,"children":u})})]}),Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesRight,"children":[Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesScore1,"children":[Object(I.jsx)(l.View,{"className":p.a.hotRecommedSeriesCrow,"children":"大众："}),e.publicScore&&0!==parseInt(e.publicScore)&&e.publicScorePeople>=100?Object(I.jsx)(l.View,{"className":p.a.hotRecommedCrowScore,"children":Object(w.g)(e.publicScore)}):Object(I.jsx)(l.View,{"className":p.a.hotRecommedCrowScoreNo,"children":"暂无"})]}),Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesScore2,"children":[Object(I.jsx)(l.View,{"className":p.a.hotRecommedSeriesCrow,"children":"专家："}),e.performanceScore&&0!==parseInt(e.performanceScore)?Object(I.jsx)(l.View,{"className":p.a.hotRecommedCrowScore,"children":Object(w.g)(e.performanceScore)}):Object(I.jsx)(l.View,{"className":p.a.hotRecommedCrowScoreNo,"children":"暂无"})]})]})]}),Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesInfo,"children":[Object(I.jsxs)(l.View,{"className":p.a.hotRecommedSeriesText,"children":[m,"上映"]}),Object(I.jsx)(l.View,{"className":p.a.hotRecommedSeriesText,"children":e.publicScorePeople&&e.publicScorePeople>=1e3?"累计".concat(e.publicScorePeople,"人参与评分"):""})]})]})]},t)}))})})),T=c(222),N=c(226),V=Object(R.a)((function SearchResult(e){var t=e.searchText,c=e.handleSelect,a=e.listId,o=e.moreTextHandle,m=e.current,u=e.setListChoose,h=e.setListChooseOld,_=Object(d.useState)([]),x=Object(s.a)(_,2),j=x[0],f=x[1],O=Object(d.useState)(!0),S=Object(s.a)(O,2),p=S[0],w=S[1],R=Object(d.useState)(!1),g=Object(s.a)(R,2),V=g[0],C=g[1],k=Object(d.useState)(1),y=Object(s.a)(k,2),F=y[0],D=y[1],L=function(){var e=Object(r.a)(n.a.mark((function _callee(e,t,c){var o,r;return n.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return o=c?[]:j,n.next=3,Object(T.b)(e,t,a);case 3:(r=n.sent).length>0?o=o.concat(r):w(!1),f(o),u(o.filter((function(e){return e.existFlag}))),h(o.filter((function(e){return e.existFlag}))),C(!0);case 9:case"end":return n.stop()}}),_callee)})));return function getAsyncData(t,c,a){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){D(1),f([]),w(!0),L(t,1,!0)}),[t]),i.default.useReachBottom((function(){if(!p)return!1;var e=F;e++,D(e),L(t,e,!1)})),Object(I.jsxs)(l.View,{"className":b.a.hotRecommed,"children":[Object(I.jsx)(N.a,{"text":"作品列表","btnText":"添加作品","gotoNew":o,"flag":!0,"current":m}),j.length>0&&Object(I.jsx)(v,{"isFromSourch":!0,"feedData":j,"handleSelect":c}),0===j.length&&V&&Object(I.jsxs)(l.View,{"className":b.a.noSearchResult,"children":[Object(I.jsx)(l.View,{"className":b.a.noSearchIcon}),Object(I.jsx)(l.View,{"className":b.a.noSearchText,"children":"未找到相关信息，建议尝试更换关键词"})]})]})})),C=c(352),k=c.n(C),y=Object(R.a)((function HotRecommend(e){var t=e.handleSelect,c=e.listId,a=e.moreTextHandle,o=e.current,i=e.setListChoose,m=e.setListChooseOld,u=Object(d.useState)([]),h=Object(s.a)(u,2),_=h[0],x=h[1],j=function(){var e=Object(r.a)(n.a.mark((function _callee(){var e;return n.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.d)(c);case 2:(e=t.sent).length>0&&(e=e.slice(0,6),x(e),i(e.filter((function(e){return e.existFlag}))),m(e.filter((function(e){return e.existFlag}))));case 4:case"end":return t.stop()}}),_callee)})));return function getAsyncData(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){j()}),[]),Object(I.jsxs)(l.View,{"className":k.a.hotRecommed,"children":[Object(I.jsx)(N.a,{"text":"热门推荐","btnText":"添加作品","gotoNew":a,"flag":!0,"current":o}),_.length>0&&Object(I.jsx)(v,{"feedData":_,"handleSelect":t,"setData":x})]})})),F=c(13),D=function(){var e=Object(r.a)(n.a.mark((function _callee(e){var t,c,a,o;return n.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return t=e.listId,c=e.list,n.prev=1,n.next=4,Object(F.e)({"method":"PUT","url":F.c+"/wind-vane-portal/user/list/addDramas/".concat(t),"data":{"body":c}});case 4:return a=n.sent,o=a.data,n.abrupt("return",o);case 9:return n.prev=9,n.t0=n.catch(1),n.abrupt("return",null);case 12:case"end":return n.stop()}}),_callee,null,[[1,9]])})));return function addDramas(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(r.a)(n.a.mark((function _callee2(e){var t,c,a,o;return n.a.wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return t=e.listId,c=e.list,n.prev=1,n.next=4,Object(F.e)({"method":"PUT","url":F.c+"/wind-vane-portal/user/list/deleteDramas/".concat(t),"data":{"body":c}});case 4:return a=n.sent,o=a.data,n.abrupt("return",o);case 9:return n.prev=9,n.t0=n.catch(1),n.abrupt("return",null);case 12:case"end":return n.stop()}}),_callee2,null,[[1,9]])})));return function delDramas(t){return e.apply(this,arguments)}}();function AddOpus(){var e=i.default.useRouter().params.listId,t=void 0===e?"":e,c=Object(d.useState)(""),o=Object(s.a)(c,2),m=o[0],j=o[1],b=Object(d.useState)([]),f=Object(s.a)(b,2),O=f[0],S=f[1],p=Object(d.useState)([]),w=Object(s.a)(p,2),R=w[0],g=w[1],v=Object(d.useState)([]),T=Object(s.a)(v,2),N=T[0],C=T[1],k=Object(d.useState)([]),F=Object(s.a)(k,2),P=F[0],B=F[1],H=function(){var e=Object(r.a)(n.a.mark((function _callee(){var e,c;return n.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(console.log("保存"),console.log(O,R),!O.length&&!R.length){a.next=14;break}if(!O.length){a.next=7;break}return a.next=6,D({"listId":t,"list":O.map((function(e){return e.dramaId}))});case 6:e=a.sent;case 7:if(!R.length){a.next=11;break}return a.next=10,L({"listId":t,"list":R.map((function(e){return e.dramaId}))});case 10:c=a.sent;case 11:e&&200===e.code||c&&200===c.code?Object(i.showToast)({"title":"操作成功","icon":"success","duration":3e3,"complete":function complete(){i.default.navigateBack({"delta":1})}}):Object(i.showToast)({"title":"操作失败","icon":"error","duration":3e3}),a.next=15;break;case 14:N.length?Object(i.showToast)({"title":"作品已经存在片单中","icon":"none"}):Object(i.showToast)({"title":"请选择需要增加的作品","icon":"none"});case 15:case"end":return a.stop()}}),_callee)})));return function moreTextHandle(){return e.apply(this,arguments)}}(),J=Object(d.useCallback)((function(e){j(e)}),[m]),M=function handleSelect(e,t){var c=O.findIndex((function(t){return t.dramaId===e.dramaId})),o=R.findIndex((function(t){return t.dramaId===e.dramaId})),n=P.findIndex((function(t){return t.dramaId===e.dramaId})),r=t.filter((function(e){return e.existFlag}));if(e.existFlag){if(c<0&&n<0&&S([].concat(Object(a.a)(O),[e])),o>-1){var s=Object(a.a)(R);s.splice(c,1),g(s)}}else{if(O.length&&c>-1){var i=Object(a.a)(O);i.splice(c,1),S(i)}c<0&&g([].concat(Object(a.a)(R),[e]))}C(r)};return Object(I.jsxs)(l.View,{"className":u.a.addOpus,"children":[Object(I.jsx)(h.a,{"content":{"title":"作品管理","imageUrl":"https://x0.ifengimg.com/fe/custom/comment_bg.png","prevIcon":"https://x0.ifengimg.com/fe/ifengVane/icon_back.png","fizeColor":"#000"}}),Object(I.jsxs)(l.View,{"className":u.a.pageBody,"children":[Object(I.jsx)(x.a,{"searchText":m,"searchTextChangeHandle":J}),m?Object(I.jsx)(l.View,{"className":u.a.hotModule,"children":Object(I.jsx)(V,{"searchText":m,"handleSelect":M,"listId":t,"moreTextHandle":H,"current":N.length>0,"setListChoose":C,"setListChooseOld":B})}):Object(I.jsx)(y,{"handleSelect":M,"listId":t,"moreTextHandle":H,"current":N.length>0,"setListChoose":C,"setListChooseOld":B}),Object(I.jsx)(_.a,{})]})]})}}}]);